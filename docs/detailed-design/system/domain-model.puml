@startuml System Management Domain Model

!define AGGREGATE_COLOR #FFE4B5
!define ENTITY_COLOR #E0F2F7
!define VALUE_OBJECT_COLOR #FFF9C4
!define ENUM_COLOR #E1BEE7

skinparam class {
    BackgroundColor<<AggregateRoot>> AGGREGATE_COLOR
    BackgroundColor<<Entity>> ENTITY_COLOR
    BackgroundColor<<ValueObject>> VALUE_OBJECT_COLOR
    BackgroundColor<<Enum>> ENUM_COLOR
    BorderColor Black
    ArrowColor Black
    FontSize 12
}

' Aggregate Roots
class MaintenanceWindow <<AggregateRoot>> {
    + MaintenanceId: Guid
    + ScheduledStartTime: DateTime
    + EstimatedDuration: TimeSpan
    + MaintenanceType: MaintenanceType
    + AffectedServices: List<string>
    + StartTime: DateTime?
    + CompletedTime: DateTime?
    + ActualDuration: TimeSpan?
    + Status: MaintenanceStatus
    + CreatedAt: DateTime
    + UpdatedAt: DateTime?
    --
    + Schedule(): MaintenanceWindow
    + Start(): void
    + Complete(): void
    + UpdateSchedule(): void
}

class SystemBackup <<AggregateRoot>> {
    + BackupId: Guid
    + BackupType: BackupType
    + StartedAt: DateTime
    + CompletedAt: DateTime?
    + BackupSize: long?
    + Duration: TimeSpan?
    + BackupLocation: string?
    + Status: BackupStatus
    + FailureReason: string?
    + CreatedAt: DateTime
    --
    + Start(): SystemBackup
    + Complete(): void
    + Fail(): void
}

class SystemError <<AggregateRoot>> {
    + ErrorId: Guid
    + ErrorType: string
    + ErrorMessage: string
    + StackTrace: string
    + Severity: ErrorSeverity
    + AffectedAccounts: int
    + OccurredAt: DateTime
    + IsResolved: bool
    + ResolvedAt: DateTime?
    + Resolution: string?
    --
    + Create(): SystemError
    + Resolve(): void
}

class PerformanceMetric <<AggregateRoot>> {
    + MetricId: Guid
    + MetricName: string
    + ThresholdValue: double
    + ActualValue: double
    + Duration: TimeSpan
    + RecordedAt: DateTime
    + ThresholdExceeded: bool
    + AcknowledgedAt: DateTime?
    --
    + Record(): PerformanceMetric
    + Acknowledge(): void
}

' Enumerations
enum MaintenanceType <<Enum>> {
    Planned
    Emergency
}

enum MaintenanceStatus <<Enum>> {
    Scheduled
    InProgress
    Completed
    Cancelled
}

enum BackupType <<Enum>> {
    Full
    Incremental
    Differential
}

enum BackupStatus <<Enum>> {
    Scheduled
    InProgress
    Completed
    Failed
}

enum ErrorSeverity <<Enum>> {
    Low
    Medium
    High
    Critical
}

' Relationships
MaintenanceWindow --> MaintenanceType : has
MaintenanceWindow --> MaintenanceStatus : has
SystemBackup --> BackupType : has
SystemBackup --> BackupStatus : has
SystemError --> ErrorSeverity : has

' Base Classes
abstract class AggregateRoot {
    # _domainEvents: List<DomainEvent>
    + DomainEvents: IReadOnlyCollection<DomainEvent>
    --
    # AddDomainEvent(DomainEvent): void
    + ClearDomainEvents(): void
}

MaintenanceWindow --|> AggregateRoot
SystemBackup --|> AggregateRoot
SystemError --|> AggregateRoot
PerformanceMetric --|> AggregateRoot

' Domain Events Package
package "Domain Events" <<Rectangle>> {
    class MaintenanceScheduledDomainEvent {
        + MaintenanceId: Guid
        + ScheduledStartTime: DateTime
        + EstimatedDuration: TimeSpan
        + MaintenanceType: MaintenanceType
        + AffectedServices: List<string>
    }

    class MaintenanceStartedDomainEvent {
        + MaintenanceId: Guid
        + StartTime: DateTime
    }

    class MaintenanceCompletedDomainEvent {
        + MaintenanceId: Guid
        + CompletedTime: DateTime
        + ActualDuration: TimeSpan
    }

    class BackupStartedDomainEvent {
        + BackupId: Guid
        + BackupType: BackupType
    }

    class BackupCompletedDomainEvent {
        + BackupId: Guid
        + BackupSize: long
        + Duration: TimeSpan
        + BackupLocation: string
    }

    class BackupFailedDomainEvent {
        + BackupId: Guid
        + FailureReason: string
    }

    class SystemErrorOccurredDomainEvent {
        + ErrorId: Guid
        + ErrorType: string
        + ErrorMessage: string
        + StackTrace: string
        + Severity: ErrorSeverity
        + AffectedAccounts: int
    }

    class PerformanceThresholdExceededDomainEvent {
        + MetricName: string
        + ThresholdValue: double
        + ActualValue: double
        + Duration: TimeSpan
    }
}

' Event relationships
MaintenanceWindow ..> MaintenanceScheduledDomainEvent : raises
MaintenanceWindow ..> MaintenanceStartedDomainEvent : raises
MaintenanceWindow ..> MaintenanceCompletedDomainEvent : raises
SystemBackup ..> BackupStartedDomainEvent : raises
SystemBackup ..> BackupCompletedDomainEvent : raises
SystemBackup ..> BackupFailedDomainEvent : raises
SystemError ..> SystemErrorOccurredDomainEvent : raises
PerformanceMetric ..> PerformanceThresholdExceededDomainEvent : raises

note top of MaintenanceWindow
    Aggregate Root for managing
    system maintenance windows
end note

note top of SystemBackup
    Aggregate Root for managing
    system backup operations
end note

note top of SystemError
    Aggregate Root for tracking
    and managing system errors
end note

note top of PerformanceMetric
    Aggregate Root for recording
    and monitoring performance metrics
end note

@enduml
