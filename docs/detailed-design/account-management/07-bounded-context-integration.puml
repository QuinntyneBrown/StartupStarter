@startuml
title Account Management - Bounded Context Integration

skinparam componentStyle rectangle

package "Account Management BC" {
    component "Account Aggregate" as Account
    component "Event Publisher" as Publisher
    
    Account -> Publisher : publishes events
}

package "User Management BC" {
    component "User Aggregate" as User
    component "Account Event Subscriber" as UserSub
    
    note right of UserSub
        Subscribes to:
        - AccountCreated
        - AccountDeleted
        - AccountOwnerChanged
        
        Actions:
        - Validate owner exists
        - Update user account reference
        - Handle ownership transfer
    end note
}

package "Profile Management BC" {
    component "Profile Aggregate" as Profile
    component "Account Event Subscriber" as ProfileSub
    
    note right of ProfileSub
        Subscribes to:
        - AccountProfileAdded
        - AccountProfileRemoved
        - AccountDeleted
        - AccountSuspended
        
        Actions:
        - Create/remove profile
        - Cascade delete profiles
        - Suspend profile access
    end note
}

package "Billing BC" {
    component "Subscription Aggregate" as Billing
    component "Account Event Subscriber" as BillingSub
    
    note right of BillingSub
        Subscribes to:
        - AccountCreated
        - AccountSubscriptionChanged
        - AccountDeleted
        - AccountSuspended
        
        Actions:
        - Setup billing
        - Change subscription plan
        - Cancel subscription
        - Suspend billing
    end note
}

package "Audit Log BC" {
    component "Audit Entry" as Audit
    component "Account Event Subscriber" as AuditSub
    
    note right of AuditSub
        Subscribes to:
        - All Account events
        
        Actions:
        - Record all changes
        - Maintain audit trail
        - Compliance logging
    end note
}

package "Notification BC" {
    component "Notification Service" as Notification
    component "Account Event Subscriber" as NotifSub
    
    note right of NotifSub
        Subscribes to:
        - AccountCreated
        - AccountSuspended
        - AccountReactivated
        - AccountOwnerChanged
        
        Actions:
        - Send welcome email
        - Alert on suspension
        - Notify owner change
    end note
}

queue "Event Bus\nAzure Service Bus / Kafka" as EventBus

Publisher --> EventBus : publish domain events
EventBus --> UserSub : deliver events
EventBus --> ProfileSub : deliver events
EventBus --> BillingSub : deliver events
EventBus --> AuditSub : deliver events
EventBus --> NotifSub : deliver events

note bottom of EventBus
    Event-Driven Integration:
    - Loose coupling between BCs
    - Async communication
    - Eventually consistent
    - Each BC maintains own data
    - No direct dependencies
    - Scalable architecture
end note

legend right
    Events Published by Account BC:
    
    - AccountCreated
    - AccountUpdated
    - AccountDeleted
    - AccountSuspended
    - AccountReactivated
    - AccountSubscriptionChanged
    - AccountOwnerChanged
    - AccountSettingsUpdated
    - AccountProfileAdded
    - AccountProfileRemoved
    
    Communication:
    - Publish/Subscribe pattern
    - At-least-once delivery
    - Idempotent consumers
    - Dead letter queue for failures
endlegend

@enduml
