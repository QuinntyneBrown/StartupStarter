@startuml Content Domain Model

!define AGGREGATE_ROOT_COLOR #FFE6CC
!define ENTITY_COLOR #E1F5FF
!define VALUE_OBJECT_COLOR #F3E5F5
!define DOMAIN_EVENT_COLOR #FFF9C4

' Aggregate Root
class Content <<AggregateRoot>> AGGREGATE_ROOT_COLOR {
    +Guid ContentId
    +string ContentType
    +string Title
    +string Body
    +Guid AuthorId
    +Guid AccountId
    +Guid? ProfileId
    +ContentStatus Status
    +int CurrentVersionNumber
    +DateTime? PublishDate
    +DateTime? ScheduledPublishDate
    +DateTime CreatedAt
    +DateTime? UpdatedAt
    +DateTime? DeletedAt
    +bool IsDeleted
    --
    +static Create(): Content
    +Update(): void
    +Publish(): void
    +Unpublish(): void
    +ChangeStatus(): void
    +CreateVersion(): void
    +RestoreVersion(): void
    +Schedule(): void
    +CancelSchedule(): void
    +Delete(): void
}

' Entities
class ContentVersion <<Entity>> ENTITY_COLOR {
    +Guid VersionId
    +Guid ContentId
    +int VersionNumber
    +string Title
    +string Body
    +string ChangeDescription
    +Guid CreatedBy
    +DateTime CreatedAt
    --
    +static Create(): ContentVersion
}

class ContentMetadata <<Entity>> ENTITY_COLOR {
    +Guid MetadataId
    +Guid ContentId
    +string Key
    +string Value
    +string DataType
    --
    +static Create(): ContentMetadata
    +UpdateValue(): void
}

' Value Objects
enum ContentStatus <<ValueObject>> VALUE_OBJECT_COLOR {
    Draft
    Review
    Published
    Archived
    Scheduled
}

enum DeletionType <<ValueObject>> VALUE_OBJECT_COLOR {
    SoftDelete
    HardDelete
}

' Domain Events
abstract class DomainEvent DOMAIN_EVENT_COLOR {
    +Guid EventId
    +DateTime OccurredAt
}

class ContentCreatedDomainEvent DOMAIN_EVENT_COLOR {
    +Guid ContentId
    +string ContentType
    +string Title
    +Guid AuthorId
    +Guid AccountId
    +Guid? ProfileId
    +ContentStatus Status
}

class ContentUpdatedDomainEvent DOMAIN_EVENT_COLOR {
    +Guid ContentId
    +string ContentType
    +Guid AccountId
    +Guid UpdatedBy
    +Dictionary<string,object> UpdatedFields
    +int VersionNumber
}

class ContentPublishedDomainEvent DOMAIN_EVENT_COLOR {
    +Guid ContentId
    +string ContentType
    +Guid AccountId
    +Guid PublishedBy
    +DateTime PublishDate
    +bool ScheduledPublish
}

class ContentDeletedDomainEvent DOMAIN_EVENT_COLOR {
    +Guid ContentId
    +string ContentType
    +Guid AccountId
    +Guid DeletedBy
    +DeletionType DeletionType
}

class ContentStatusChangedDomainEvent DOMAIN_EVENT_COLOR {
    +Guid ContentId
    +string ContentType
    +Guid AccountId
    +string PreviousStatus
    +string NewStatus
    +Guid ChangedBy
}

class ContentVersionCreatedDomainEvent DOMAIN_EVENT_COLOR {
    +Guid ContentId
    +Guid AccountId
    +int VersionNumber
    +Guid CreatedBy
    +string ChangeDescription
}

class ContentVersionRestoredDomainEvent DOMAIN_EVENT_COLOR {
    +Guid ContentId
    +Guid AccountId
    +int RestoredVersionNumber
    +int CurrentVersionNumber
    +Guid RestoredBy
}

class ContentScheduledDomainEvent DOMAIN_EVENT_COLOR {
    +Guid ContentId
    +Guid AccountId
    +DateTime ScheduledPublishDate
    +Guid ScheduledBy
}

' External References
class User <<External>> {
    +Guid UserId
    +string Name
}

class Account <<External>> {
    +Guid AccountId
    +string Name
}

class Profile <<External>> {
    +Guid ProfileId
    +string Name
}

' Relationships
Content "1" *-- "many" ContentVersion : has versions >
Content "1" *-- "many" ContentMetadata : has metadata >
Content --> ContentStatus : has status
Content --> User : created by
Content --> Account : belongs to
Content --> Profile : associated with

Content ..> ContentCreatedDomainEvent : raises
Content ..> ContentUpdatedDomainEvent : raises
Content ..> ContentPublishedDomainEvent : raises
Content ..> ContentDeletedDomainEvent : raises
Content ..> ContentStatusChangedDomainEvent : raises
Content ..> ContentVersionCreatedDomainEvent : raises
Content ..> ContentVersionRestoredDomainEvent : raises
Content ..> ContentScheduledDomainEvent : raises

ContentCreatedDomainEvent --|> DomainEvent
ContentUpdatedDomainEvent --|> DomainEvent
ContentPublishedDomainEvent --|> DomainEvent
ContentDeletedDomainEvent --|> DomainEvent
ContentStatusChangedDomainEvent --|> DomainEvent
ContentVersionCreatedDomainEvent --|> DomainEvent
ContentVersionRestoredDomainEvent --|> DomainEvent
ContentScheduledDomainEvent --|> DomainEvent

note right of Content
  Aggregate Root following DDD principles
  Encapsulates business logic and invariants
  Raises domain events for state changes
end note

note right of ContentVersion
  Immutable version snapshot
  Enables version history and restore
end note

@enduml
