<mxfile host="app.diagrams.net" modified="2024-12-19T00:00:00.000Z" agent="5.0" version="24.0.0">
  <diagram name="Content Clean Architecture" id="content-clean-arch">
    <mxGraphModel dx="1434" dy="844" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1600" pageHeight="1200" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />

        <!-- Title -->
        <mxCell id="title" value="Content Management - Clean Architecture" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=24;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="600" y="20" width="400" height="40" as="geometry" />
        </mxCell>

        <!-- Presentation Layer (Angular 21) -->
        <mxCell id="presentation-layer" value="Presentation Layer" style="swimlane;fillColor=#E1F5FE;strokeColor=#01579B;fontStyle=1;fontSize=14;startSize=30;" vertex="1" parent="1">
          <mxGeometry x="100" y="80" width="1400" height="180" as="geometry" />
        </mxCell>

        <mxCell id="angular-app" value="Angular 21 Admin UI" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#BBDEFB;strokeColor=#1976D2;fontStyle=1" vertex="1" parent="presentation-layer">
          <mxGeometry x="40" y="50" width="200" height="100" as="geometry" />
        </mxCell>

        <mxCell id="content-list" value="Content List Component&#xa;- View all content&#xa;- Filter by status&#xa;- Pagination" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E3F2FD;strokeColor=#1976D2;align=left;spacingLeft=10;" vertex="1" parent="presentation-layer">
          <mxGeometry x="280" y="50" width="200" height="100" as="geometry" />
        </mxCell>

        <mxCell id="content-editor" value="Content Editor Component&#xa;- Create/Edit content&#xa;- Rich text editor&#xa;- Auto-save draft" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E3F2FD;strokeColor=#1976D2;align=left;spacingLeft=10;" vertex="1" parent="presentation-layer">
          <mxGeometry x="520" y="50" width="200" height="100" as="geometry" />
        </mxCell>

        <mxCell id="version-history" value="Version History Component&#xa;- View versions&#xa;- Compare versions&#xa;- Restore version" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E3F2FD;strokeColor=#1976D2;align=left;spacingLeft=10;" vertex="1" parent="presentation-layer">
          <mxGeometry x="760" y="50" width="200" height="100" as="geometry" />
        </mxCell>

        <mxCell id="content-service-angular" value="Content Service (Angular)&#xa;- HTTP calls to API&#xa;- SignalR connection&#xa;- State management" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E3F2FD;strokeColor=#1976D2;align=left;spacingLeft=10;" vertex="1" parent="presentation-layer">
          <mxGeometry x="1000" y="50" width="200" height="100" as="geometry" />
        </mxCell>

        <!-- API/Presentation Layer (.NET) -->
        <mxCell id="api-layer" value="API Layer (.NET Core)" style="swimlane;fillColor=#FFF9C4;strokeColor=#F57F17;fontStyle=1;fontSize=14;startSize=30;" vertex="1" parent="1">
          <mxGeometry x="100" y="290" width="1400" height="180" as="geometry" />
        </mxCell>

        <mxCell id="api-gateway" value="API Gateway&#xa;- JWT Authentication&#xa;- Rate Limiting&#xa;- Request Routing" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFF59D;strokeColor=#F57F17;align=left;spacingLeft=10;" vertex="1" parent="api-layer">
          <mxGeometry x="40" y="50" width="180" height="100" as="geometry" />
        </mxCell>

        <mxCell id="content-controller" value="ContentController&#xa;- POST /api/content&#xa;- PUT /api/content/{id}&#xa;- DELETE /api/content/{id}&#xa;- GET /api/content/{id}" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFF59D;strokeColor=#F57F17;align=left;spacingLeft=10;" vertex="1" parent="api-layer">
          <mxGeometry x="260" y="50" width="200" height="100" as="geometry" />
        </mxCell>

        <mxCell id="publish-controller" value="PublishController&#xa;- POST /content/{id}/publish&#xa;- POST /content/{id}/unpublish&#xa;- POST /content/{id}/schedule" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFF59D;strokeColor=#F57F17;align=left;spacingLeft=10;" vertex="1" parent="api-layer">
          <mxGeometry x="500" y="50" width="220" height="100" as="geometry" />
        </mxCell>

        <mxCell id="version-controller" value="VersionController&#xa;- GET /content/{id}/versions&#xa;- POST /content/{id}/restore&#xa;- GET /content/{id}/versions/{versionId}" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFF59D;strokeColor=#F57F17;align=left;spacingLeft=10;" vertex="1" parent="api-layer">
          <mxGeometry x="760" y="50" width="260" height="100" as="geometry" />
        </mxCell>

        <mxCell id="signalr-hub" value="ContentHub (SignalR)&#xa;- Real-time notifications&#xa;- Content updates&#xa;- Collaborative editing" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFF59D;strokeColor=#F57F17;align=left;spacingLeft=10;" vertex="1" parent="api-layer">
          <mxGeometry x="1060" y="50" width="200" height="100" as="geometry" />
        </mxCell>

        <!-- Application Layer -->
        <mxCell id="application-layer" value="Application Layer (MediatR)" style="swimlane;fillColor=#F3E5F5;strokeColor=#4A148C;fontStyle=1;fontSize=14;startSize=30;" vertex="1" parent="1">
          <mxGeometry x="100" y="500" width="1400" height="240" as="geometry" />
        </mxCell>

        <mxCell id="commands-title" value="Commands" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;fontStyle=1" vertex="1" parent="application-layer">
          <mxGeometry x="40" y="40" width="100" height="30" as="geometry" />
        </mxCell>

        <mxCell id="create-content-cmd" value="CreateContentCommand&#xa;CreateContentHandler" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E1BEE7;strokeColor=#4A148C;" vertex="1" parent="application-layer">
          <mxGeometry x="40" y="70" width="160" height="60" as="geometry" />
        </mxCell>

        <mxCell id="update-content-cmd" value="UpdateContentCommand&#xa;UpdateContentHandler" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E1BEE7;strokeColor=#4A148C;" vertex="1" parent="application-layer">
          <mxGeometry x="220" y="70" width="160" height="60" as="geometry" />
        </mxCell>

        <mxCell id="publish-content-cmd" value="PublishContentCommand&#xa;PublishContentHandler" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E1BEE7;strokeColor=#4A148C;" vertex="1" parent="application-layer">
          <mxGeometry x="400" y="70" width="160" height="60" as="geometry" />
        </mxCell>

        <mxCell id="schedule-content-cmd" value="ScheduleContentCommand&#xa;ScheduleContentHandler" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E1BEE7;strokeColor=#4A148C;" vertex="1" parent="application-layer">
          <mxGeometry x="580" y="70" width="160" height="60" as="geometry" />
        </mxCell>

        <mxCell id="restore-version-cmd" value="RestoreVersionCommand&#xa;RestoreVersionHandler" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E1BEE7;strokeColor=#4A148C;" vertex="1" parent="application-layer">
          <mxGeometry x="760" y="70" width="160" height="60" as="geometry" />
        </mxCell>

        <mxCell id="queries-title" value="Queries" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;fontStyle=1" vertex="1" parent="application-layer">
          <mxGeometry x="40" y="150" width="100" height="30" as="geometry" />
        </mxCell>

        <mxCell id="get-content-query" value="GetContentByIdQuery&#xa;GetContentByIdHandler" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E1BEE7;strokeColor=#4A148C;" vertex="1" parent="application-layer">
          <mxGeometry x="40" y="180" width="160" height="50" as="geometry" />
        </mxCell>

        <mxCell id="get-contents-query" value="GetContentsByAccountQuery&#xa;GetContentsByAccountHandler" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E1BEE7;strokeColor=#4A148C;" vertex="1" parent="application-layer">
          <mxGeometry x="220" y="180" width="200" height="50" as="geometry" />
        </mxCell>

        <mxCell id="get-versions-query" value="GetContentVersionsQuery&#xa;GetContentVersionsHandler" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E1BEE7;strokeColor=#4A148C;" vertex="1" parent="application-layer">
          <mxGeometry x="440" y="180" width="190" height="50" as="geometry" />
        </mxCell>

        <mxCell id="validators" value="FluentValidation&#xa;- Command validators&#xa;- Business rules&#xa;- Input validation" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E1BEE7;strokeColor=#4A148C;align=left;spacingLeft=10;" vertex="1" parent="application-layer">
          <mxGeometry x="1050" y="70" width="180" height="80" as="geometry" />
        </mxCell>

        <mxCell id="automapper" value="AutoMapper&#xa;- Entity to DTO&#xa;- DTO to Entity&#xa;- Projections" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E1BEE7;strokeColor=#4A148C;align=left;spacingLeft=10;" vertex="1" parent="application-layer">
          <mxGeometry x="1050" y="160" width="180" height="70" as="geometry" />
        </mxCell>

        <!-- Domain Layer -->
        <mxCell id="domain-layer" value="Domain Layer" style="swimlane;fillColor=#FFE6CC;strokeColor=#D65300;fontStyle=1;fontSize=14;startSize=30;" vertex="1" parent="1">
          <mxGeometry x="100" y="770" width="1400" height="200" as="geometry" />
        </mxCell>

        <mxCell id="content-aggregate" value="Content (Aggregate Root)&#xa;- Business logic&#xa;- Domain events&#xa;- Invariants enforcement" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFCCBC;strokeColor=#BF360C;fontStyle=1;align=left;spacingLeft=10;" vertex="1" parent="domain-layer">
          <mxGeometry x="40" y="50" width="200" height="120" as="geometry" />
        </mxCell>

        <mxCell id="content-version-entity" value="ContentVersion (Entity)&#xa;- Version snapshots&#xa;- Immutable history" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFCCBC;strokeColor=#BF360C;align=left;spacingLeft=10;" vertex="1" parent="domain-layer">
          <mxGeometry x="280" y="50" width="180" height="120" as="geometry" />
        </mxCell>

        <mxCell id="content-metadata" value="ContentMetadata (Entity)&#xa;- Key-value pairs&#xa;- Custom fields" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFCCBC;strokeColor=#BF360C;align=left;spacingLeft=10;" vertex="1" parent="domain-layer">
          <mxGeometry x="500" y="50" width="180" height="120" as="geometry" />
        </mxCell>

        <mxCell id="domain-events" value="Domain Events&#xa;- ContentCreatedDomainEvent&#xa;- ContentUpdatedDomainEvent&#xa;- ContentPublishedDomainEvent&#xa;- ContentVersionCreatedDomainEvent" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFF9C4;strokeColor=#F57F17;align=left;spacingLeft=10;" vertex="1" parent="domain-layer">
          <mxGeometry x="720" y="50" width="260" height="120" as="geometry" />
        </mxCell>

        <mxCell id="value-objects" value="Value Objects&#xa;- ContentStatus enum&#xa;- DeletionType enum" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFCCBC;strokeColor=#BF360C;align=left;spacingLeft=10;" vertex="1" parent="domain-layer">
          <mxGeometry x="1020" y="50" width="180" height="120" as="geometry" />
        </mxCell>

        <mxCell id="interfaces" value="Repository Interfaces&#xa;- IContentRepository&#xa;- Persistence abstractions" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFCCBC;strokeColor=#BF360C;align=left;spacingLeft=10;" vertex="1" parent="domain-layer">
          <mxGeometry x="1240" y="50" width="140" height="120" as="geometry" />
        </mxCell>

        <!-- Infrastructure Layer -->
        <mxCell id="infrastructure-layer" value="Infrastructure Layer" style="swimlane;fillColor=#C8E6C9;strokeColor=#1B5E20;fontStyle=1;fontSize=14;startSize=30;" vertex="1" parent="1">
          <mxGeometry x="100" y="1000" width="1400" height="180" as="geometry" />
        </mxCell>

        <mxCell id="ef-core" value="Entity Framework Core&#xa;- DbContext&#xa;- Migrations&#xa;- Query optimization" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#A5D6A7;strokeColor=#1B5E20;align=left;spacingLeft=10;" vertex="1" parent="infrastructure-layer">
          <mxGeometry x="40" y="50" width="200" height="100" as="geometry" />
        </mxCell>

        <mxCell id="content-repository-impl" value="ContentRepository&#xa;- IContentRepository impl&#xa;- EF Core queries&#xa;- Transaction management" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#A5D6A7;strokeColor=#1B5E20;align=left;spacingLeft=10;" vertex="1" parent="infrastructure-layer">
          <mxGeometry x="280" y="50" width="200" height="100" as="geometry" />
        </mxCell>

        <mxCell id="event-dispatcher" value="Domain Event Dispatcher&#xa;- Event publishing&#xa;- Integration events&#xa;- Service Bus integration" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#A5D6A7;strokeColor=#1B5E20;align=left;spacingLeft=10;" vertex="1" parent="infrastructure-layer">
          <mxGeometry x="520" y="50" width="200" height="100" as="geometry" />
        </mxCell>

        <mxCell id="signalr-service" value="SignalR Service&#xa;- Real-time notifications&#xa;- Hub connections&#xa;- Group management" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#A5D6A7;strokeColor=#1B5E20;align=left;spacingLeft=10;" vertex="1" parent="infrastructure-layer">
          <mxGeometry x="760" y="50" width="200" height="100" as="geometry" />
        </mxCell>

        <mxCell id="background-jobs" value="Background Jobs&#xa;- Hangfire/Azure Functions&#xa;- Scheduled publishing&#xa;- Clean-up tasks" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#A5D6A7;strokeColor=#1B5E20;align=left;spacingLeft=10;" vertex="1" parent="infrastructure-layer">
          <mxGeometry x="1000" y="50" width="200" height="100" as="geometry" />
        </mxCell>

        <!-- External Services -->
        <mxCell id="external-layer" value="External Services" style="swimlane;fillColor=#CFD8DC;strokeColor=#263238;fontStyle=1;fontSize=14;startSize=30;" vertex="1" parent="1">
          <mxGeometry x="100" y="1210" width="1400" height="120" as="geometry" />
        </mxCell>

        <mxCell id="sql-server" value="Azure SQL Database&#xa;- Content storage&#xa;- Relational data" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#B0BEC5;strokeColor=#263238;" vertex="1" parent="external-layer">
          <mxGeometry x="40" y="50" width="180" height="50" as="geometry" />
        </mxCell>

        <mxCell id="service-bus" value="Azure Service Bus&#xa;- Event messaging&#xa;- Pub/Sub" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#B0BEC5;strokeColor=#263238;" vertex="1" parent="external-layer">
          <mxGeometry x="260" y="50" width="180" height="50" as="geometry" />
        </mxCell>

        <mxCell id="blob-storage" value="Azure Blob Storage&#xa;- Media files&#xa;- Attachments" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#B0BEC5;strokeColor=#263238;" vertex="1" parent="external-layer">
          <mxGeometry x="480" y="50" width="180" height="50" as="geometry" />
        </mxCell>

        <mxCell id="redis-cache" value="Azure Redis Cache&#xa;- Distributed cache&#xa;- Session state" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#B0BEC5;strokeColor=#263238;" vertex="1" parent="external-layer">
          <mxGeometry x="700" y="50" width="180" height="50" as="geometry" />
        </mxCell>

        <mxCell id="app-insights" value="Application Insights&#xa;- Logging&#xa;- Monitoring" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#B0BEC5;strokeColor=#263238;" vertex="1" parent="external-layer">
          <mxGeometry x="920" y="50" width="180" height="50" as="geometry" />
        </mxCell>

        <!-- Dependency Arrows -->
        <mxCell id="arrow1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#1976D2;dashed=1;" edge="1" parent="1" source="content-service-angular" target="api-gateway">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="arrow2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#F57F17;dashed=1;" edge="1" parent="1" source="content-controller" target="create-content-cmd">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="arrow3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#4A148C;dashed=1;" edge="1" parent="1" source="create-content-cmd" target="content-aggregate">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="arrow4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#4A148C;dashed=1;" edge="1" parent="1" source="create-content-cmd" target="content-repository-impl">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="arrow5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#1B5E20;dashed=1;" edge="1" parent="1" source="content-repository-impl" target="sql-server">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Legend -->
        <mxCell id="legend" value="Dependency Flow: UI → API → Application → Domain ← Infrastructure → External Services" style="text;html=1;strokeColor=#1976D2;fillColor=#E1F5FE;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=1;fontSize=12;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="550" y="1360" width="500" height="30" as="geometry" />
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
